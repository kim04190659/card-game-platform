module.exports = async (req, res) => {
  if (req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }

  // 少し待機してAI生成をシミュレート
  await new Promise(resolve => setTimeout(resolve, 1000));

  // リクエストからgameIdを取得
  const { gameId } = req.body;

  // gameIdに応じて異なるモックを返す
  let mockOutput;

  if (gameId === 'robot-solution') {
    // ロボットソリューション用モック
    mockOutput = `
# 介護施設向け見守りロボットソリューション提案書

## 1. エグゼクティブサマリー
介護施設における人手不足と夜間見守りの課題を、AI搭載の自律移動ロボットで解決します。
既存の施設管理システムとの統合により、低コストで実現可能なソリューションを提案します。

## 2. 顧客課題の分析
### 2.1 現状の課題
- 夜間の見守り業務で職員の負担が大きい
- 転倒・徘徊の早期発見が困難
- 人材確保が困難で、現場が疲弊している

### 2.2 課題の定量化
- 夜勤職員の平均労働時間: 12時間/日
- 転倒事故の発生率: 月平均3-5件
- 職員の離職率: 年間20%

## 3. 競合分析と差別化戦略
### 3.1 競合状況
- 既存の手作業による見守り: コスト大、品質不安定
- 他社の見守りロボット: 高価（1台500万円以上）
- 固定カメラシステム: 死角が多い

### 3.2 当社の差別化ポイント
- AI画像認識による異常検知の高精度化
- 自律移動により死角なし
- 既存システムとの連携でコスト削減（1台300万円）
- パートナー企業との協業により短期導入可能

## 4. 提案ソリューションの概要
### 4.1 システム構成
- 自律移動ロボット: 2台（施設内を巡回）
- AI画像認識エンジン: 転倒・徘徊を自動検知
- 既存の施設管理システムと連携
- スマートフォンアプリで職員に通知

### 4.2 主要機能
- 夜間巡回（2時間ごと）
- 異常検知時のアラート通知
- 音声による声かけ機能
- 記録データの分析・レポート

## 5. 技術的アプローチ（パートナー活用を含む）
### 5.1 自社開発部分（Make）
- ロボット制御ソフトウェア
- 自律移動アルゴリズム
- 施設管理システムとの連携API

### 5.2 パートナー活用部分（Buy）
- AI画像認識エンジン: パートナーA社
- センサー類: パートナーB社
- クラウド基盤: パートナーC社

## 6. チーム体制と役割分担
- プロジェクトリーダー: 1名
- ロボット制御エンジニア: 2名（自社）
- AI技術者: 1名（パートナーA社）
- システムインテグレーター: 1名（パートナーC社）

## 7. 実装計画とマイルストーン
### Phase 1: 要件定義・設計（1ヶ月）
### Phase 2: プロトタイプ開発（2ヶ月）
### Phase 3: パイロット導入（1ヶ月）
### Phase 4: 本番導入・運用開始（1ヶ月）

合計期間: 5ヶ月

## 8. コスト試算
### 初期費用
- ロボット2台: 600万円
- システム開発: 200万円
- 設置工事: 50万円
- 合計: 850万円

### 運用費用（年間）
- 保守費用: 80万円/年
- クラウド利用料: 30万円/年
- 合計: 110万円/年

### ROI試算
- 夜勤職員の削減: 1名分の人件費（年間500万円）
- 投資回収期間: 約2年

## 9. 期待される効果
### 定量的効果
- 夜間見守り業務の省人化: 職員1名削減
- 転倒事故の早期発見率: 90%以上
- 職員の負担軽減: 夜勤時間を20%削減

### 定性的効果
- 入居者の安心感向上
- 職員の離職率低下
- 施設の競争力強化

（これはテスト用のモック成果物です）
    `;
  } else {
    // デフォルト: 自治体DX用モック
    mockOutput = `
# スマート霧島プロジェクト提案書

## 1. プロジェクト概要
人口30万人の地方中核市である霧島市において、既存インフラとの統合を活かした
スマートシティ基盤を構築します。

## 2. 背景・課題
霧島市は現在、行政DXの推進と住民サービス向上という2つの課題を抱えています。

## 3. 提案内容
### 3.1 スマートシティ基盤の構築
- 既存コミュニティバスシステムとの統合
- 地域住民との協働体制の活用
- 温泉観光資源との連携

### 3.2 AI活用による行政サービス向上
- 住民問い合わせのAI対応
- データ分析による政策立案支援

## 4. 実施計画
- 期間: 2年
- 予算: 5,000万円
- 体制: 自治体職員10名 + 外部パートナー5名

## 5. 期待効果
- 行政手続きのデジタル化による効率化
- 住民満足度の向上
- 地域活性化への貢献

（これはテスト用のモック成果物です）
    `;
  }

  return res.status(200).json({
    success: true,
    content: mockOutput
  });
};
